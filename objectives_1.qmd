# Objective 1: Strategy for Scaling

**Goal:** Determine a strategy for scaling autonomous vehicles by analyzing consumer Willingness to Pay (WTP) and confidence drivers.

```{r}
#| label: load-obj1
#| echo: false
#| warning: false
#| message: false
library(tidyverse)
library(plotly)
library(ggpubr)
library(rstatix)
library(gtsummary) 
library(gt)
library(broom)
library(ggthemr)


# Load Data
df <- read.csv("./data/AVsurvey.csv")

# Re-apply factor levels for ordinal variables
# We use trimws() to ensure no accidental spaces cause mismatches
df$conf_safe <- trimws(df$conf_safe)
df$conf_right <- trimws(df$conf_right)

# Set gtsummary theme to a scientific journal standard (JAMA)
theme_gtsummary_journal(journal = "jama")

# Apply ggthemr 'flat' theme for a consistent, scientific color profile
ggthemr("fresh")
```

## The Pricing Gap: Human vs. AV

**Question**: Does the market demand a discount for AVs, or will they pay a premium?

```{r}
#| label: fig-wtp-comp
#| message: false
#| warning: false
#| fig-cap: "WTP Comparison: Private Human vs. Autonomous Vehicles"
#| fig-align: "center"
# Prepare Data
df_long <- df %>%
  select(participant_id, maxfare_1, maxfare_2) %>%
  pivot_longer(cols = starts_with("maxfare"), names_to = "Mode_Code", values_to = "WTP") %>%
  mutate(Mode = ifelse(Mode_Code == "maxfare_1", "Private (Human)", "Private (AV)"))

# Plot (ggthemr handles colors and theme)
p <- ggplot(df_long, aes(x = Mode, y = WTP, fill = Mode)) +
  geom_boxplot(alpha = 0.8, outlier.shape = NA) +
  labs(title = "WTP Comparison: Human vs. Autonomous", 
       y = "Max Fare ($) for 10 min ride",
       x = "Transport Mode") +
  theme(legend.position = "none",
        plot.title = element_text(face = "bold", size = 14))

# Conditional Output: Interactive for HTML, Static for PDF/DOCX
if (knitr::is_html_output()) {
  ggplotly(p)
} else {
  p
}
```
```{r}
#| label: tab-reg-private
#| warning: false
#| message: false
#| tab-cap: "T-test private rides"
#| tab-align: "center"
# --- Statistical Test: Paired T-Test (Formatted with gt) ---
t.test(df$maxfare_1, df$maxfare_2, paired = TRUE) %>% 
  tidy() %>% 
  select(estimate, statistic, p.value, conf.low, conf.high) %>%
  gt() %>%
  tab_header(title = "Paired T-Test: Private Human vs. AV") %>%
  fmt_number(columns = c(estimate, statistic, conf.low, conf.high), decimals = 2) %>%
  fmt_number(columns = p.value, decimals = 3) %>%
  cols_label(estimate = "Mean Diff", statistic = "t-statistic", p.value = "P-Value", 
             conf.low = "95% CI Lower", conf.high = "95% CI Upper")
```

**Analysis**: If the mean WTP for AVs is lower, the strategy must initially focus on cost-leadership or subsidization to drive adoption. Here, we see a significant difference in WTP, indicating consumers expect a discount for AV rides.

## Private vs. Shared Dynamics

**Question:** *How does the WTP degradation compare when moving from Private to Shared?*

```{r}
#| label: fig-wtp-shared
#| warning: false
#| message: false
#| fig-cap: "WTP Comparison: Shared Human vs. Shared Autonomous Vehicles"
#| fig-align: "center"

# Prepare Data
df_shared <- df %>%
  select(participant_id, maxfare_3, maxfare_4) %>%
  pivot_longer(cols = starts_with("maxfare"), names_to = "Mode_Code", values_to = "WTP") %>%
  mutate(Mode = ifelse(Mode_Code == "maxfare_3", "Shared (Human)", "Shared (AV)"))

# Plot
p2 <- ggplot(df_shared, aes(x = Mode, y = WTP, fill = Mode)) +
  geom_boxplot(alpha = 0.8) +
  labs(title = "WTP Comparison: Shared Rides", 
       y = "Max Fare ($)",
       x = "Transport Mode") +
  theme(legend.position = "none",
        plot.title = element_text(face = "bold", size = 14))

# Conditional Output: Interactive for HTML, Static for PDF/DOCX
if (knitr::is_html_output()) {
  ggplotly(p2)
} else {
  p2
}
```
```{r}
#| label: tab-reg-shared
#| warning: false
#| message: false
#| tab-cap: "T-test shared rides"
#| tab-align: "center"
# --- Statistical Test: Paired T-Test (Formatted with gt) ---
t.test(df$maxfare_3, df$maxfare_4, paired = TRUE) %>% 
  tidy() %>% 
  select(estimate, statistic, p.value, conf.low, conf.high) %>%
  gt() %>%
  tab_header(title = "Paired T-Test: Shared Human vs. AV") %>%
  fmt_number(columns = c(estimate, statistic, conf.low, conf.high), decimals = 2) %>%
  fmt_number(columns = p.value, decimals = 3) %>%
  cols_label(estimate = "Mean Diff", statistic = "t-statistic", p.value = "P-Value", 
             conf.low = "95% CI Lower", conf.high = "95% CI Upper")
```

*Analysis:* Comparing the WTP drop from Private to Shared for both Human and AV modes reveals insights into consumer preferences for ride-sharing in the context of autonomous technology. Here we see if the shared model further depresses WTP significantly.

## The Trust Premium (Safety)

**Question:** *Can we charge more if consumers trust the safety technology?*

```{r}
#| label: fig-conf-safe
#| warning: false
#| message: false

# Plot
p3 <- ggplot(df, aes(x = conf_safe, y = maxfare_2, fill = conf_safe)) +
  geom_boxplot(alpha = 0.7) +
  labs(title = "Impact of Safety Confidence on WTP", 
       x = "Confidence Level", 
       y = "WTP ($)") +
  theme(legend.position = "none",
        plot.title = element_text(face = "bold", size = 14),
         axis.text.x = element_text(angle = 45, hjust = 1))

# Conditional Output: Interactive for HTML, Static for PDF/DOCX
if (knitr::is_html_output()) {
  ggplotly(p3)
} else {
  p3
}
```
```{r}
#| label: tab-trust-anova
#| warning: false
#| message: false
#| tab-cap: "Annova-test-safety"
#| tab-align: "center"
# --- Statistical Test: ANOVA via gtsummary ---
df %>%
  select(maxfare_2, conf_safe) %>%
  tbl_summary(
    by = conf_safe,
    label = list(maxfare_2 ~ "WTP for Private AV ($)"),
    statistic = all_continuous() ~ "{mean} ({sd})",
    digits = all_continuous() ~ 2
  ) %>%
  add_p(test = maxfare_2 ~ "aov") %>% 
  add_n() %>% 
  modify_header(label = "**Variable**") %>%
  bold_labels()
```

*Analysis:* A significant ANOVA suggests that marketing spend on safety demonstration is directly convertible to higher fares. Here we assess if higher confidence in safety correlates with increased WTP for AV rides. In general, higher confidence should lead to higher WTP. Thus, safety trust-building is a key scaling lever.

## The Ethics Premium

**Question:** *Does trust in ethical algorithms drive value as much as physical safety?*

```{r}
#| label: fig-conf-ethics
#| warning: false

# Plot
p4 <- ggplot(df, aes(x = conf_right, y = maxfare_2, fill = conf_right)) +
  geom_boxplot(alpha = 0.7) +
  labs(title = "Impact of Ethical Confidence on WTP", 
       x = "Ethical Confidence", 
       y = "WTP ($)") +
  theme(legend.position = "none",
        plot.title = element_text(face = "bold", size = 14),
         axis.text.x = element_text(angle = 45, hjust = 1))

# Conditional Output: Interactive for HTML, Static for PDF/DOCX
if (knitr::is_html_output()) {
  ggplotly(p4)
} else {
  p4
}
```
```{r}
#| label: tab-ethics-anova
#| warning: false
#| message: false
#| tab-cap: "Annova-test-ethics"
#| tab-align: "center"
# --- Statistical Test: ANOVA via gtsummary ---
df %>%
  select(maxfare_2, conf_right) %>%
  tbl_summary(
    by = conf_right,
    label = list(maxfare_2 ~ "WTP for Private AV ($)"),
    statistic = all_continuous() ~ "{mean} ({sd})",
    digits = all_continuous() ~ 2
  ) %>%
  add_p(test = maxfare_2 ~ "aov") %>% 
  add_n() %>% 
  modify_header(label = "**Variable**") %>%
  bold_labels()

```

*Analysis:* If the ANOVA for ethical confidence is significant but with a lower F-value than safety, it indicates that while ethics matter, safety is the primary trust driver for WTP. Thus, ethical assurances are secondary to physical safety in scaling strategy.

## Strategic Synthesis for Scaling

Based on the data above:

1.  **Pricing:** As WTP is lower for AVs, AV firms should enter the market with competitive pricing. If the WTP gap is large, they should consider subsidies or promotions to drive initial adoption and build a safety record. This will help overcome the initial trust barrier and have consumers experience the technology firsthand.

2.  **Marketing:** Prioritize "Safety" messaging over "Ethics" as the ANOVA F-value for safety is higher. Thus, investments in safety demonstrations, transparent safety records, and endorsements from safety authorities will yield higher returns in consumer trust and WTP. If resources allow, ethical assurances can be secondary messaging.

3.  **Product Mix:** As the gap between Private AV and Shared AV is small, push Shared AVs to maximize fleet revenue per mile.

4.  **Trust-Building:** Implement programs to increase consumer confidence in AV safety, such as offering test rides, transparent reporting of safety metrics, and third-party safety certifications. This will directly translate into higher WTP and faster scaling.

5.  **Continuous Monitoring:** Regularly survey consumer confidence and WTP to adapt pricing and marketing strategies as the market matures and trust builds over time.
